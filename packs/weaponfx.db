{"_id":"LGPQdA8CUpcw5wNR","name":"AegisDefenseNet","img":"icons/svg/ice-shield.svg","type":"script","scope":"global","author":"LancerWeaponFX00","command":"//This macro is not linked to any weapon or system and must be applied manually.  It can be removed with the accompanying 'EndDefenseNet' macro, or through the Sequencer Manager\n\nnew Sequence()\n\t.effect(\"jb2a.shield.01.intro\")\n        .atLocation(token)\n        .waitUntilFinished(-700)\n        .scaleToObject(9.5)\n    .effect(\"jb2a.shield.01.loop.blue\")\n        .fadeIn(300)\n        .persist()\n        .attachTo(token, { bindVisibility: true })\n        .scaleToObject(9.5)        \n.play()"}
{"_id":"RPjF4SvsMP3dolyX","name":"AMR","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/supersonic-bullet.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/WeaponClick.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n        .waitUntilFinished(200)\n       .sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/AMR_Fire.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));\n    sequence.effect()\n        .file(\"jb2a.bullet.Snipe.blue\")\n        .filter(\"ColorMatrix\", {hue: 200})\n        .atLocation(sourceToken)\n        .stretchTo(target)\n        .missed(targetsMissed.has(target.id));\n    if (!targetsMissed.has(target.id)) {\n        sequence.sound()\n            .file(\"modules/lancer-weapon-fx/soundfx/AMR_Impact.ogg\")\n            .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n            .delay(75);\n        sequence.effect()\n            .file(\"jb2a.impact.orange.0\")\n            .atLocation(target)\n            .rotateTowards(sourceToken)\n            .rotate(230)\n            .center()\n            .delay(75)\n            .waitUntilFinished();\n    }\n}\nsequence.play();"}
{"_id":"XYVkQ3LALbGc6B7i","name":"Annihilator","type":"script","author":"LancerWeaponFX00","img":"modules/JB2A_DnD5e/Library/Cantrip/Eldritch_Blast/EldritchBlast_01_Regular_Purple_Thumb.webp","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Annihilator_Charge.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));\n    sequence.effect()\n        .file(\"jb2a.eldritch_blast.purple\")\n        .startTime(900)\n        .scale(.86)\n        .atLocation(sourceToken)\n        .stretchTo(target)\n        .missed(targetsMissed.has(target.id))\n        .name(\"impact\")\n        .waitUntilFinished(-4000);\n    if (!targetsMissed.has(target.id)) {\n        sequence.sound()\n            .file(\"modules/lancer-weapon-fx/soundfx/Annihilator.ogg\")\n            .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));\n        sequence.effect()\n            .file(\"jb2a.impact.blue.3\")\n            .scale(1.0)\n            .tint(\"#c91af9\")\n            .atLocation(target)\n            .waitUntilFinished(-400);\n    } else {\n\t\tsequence.sound()\n            .file(\"modules/lancer-weapon-fx/soundfx/Annihilator.ogg\")\n            .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));\n        sequence.effect()\n            .file(\"jb2a.impact.blue.3\")\n            .scale(1.0)\n            .tint(\"#c91af9\")\n            .atLocation(\"impact\")\n            .waitUntilFinished(-400);\n\t}\t\n}\nsequence.play();"}
{"_id":"Ui60K7EYoOV23KNM","name":"Apocalypse Rail","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/target-laser.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nconst target = game.modules.get(\"lancer-weapon-fx\").api.getTargetLocationsFromTokenGroup(targetTokens, 1)[0];\n\nlet sequence = new Sequence()\n    .sound()\n    .file(\"modules/lancer-weapon-fx/soundfx/APR2_Load.ogg\")\n    .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n    .waitUntilFinished()\n\n    .sound()\n    .file(\"modules/lancer-weapon-fx/soundfx/APR2_Fire.ogg\")\n    .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n\n    .effect()\n    .file(\"jb2a.bullet.01.orange\")\n    .atLocation(sourceToken)\n    .stretchTo(target)\n    .scale(2.0)\n    .waitUntilFinished(-300);\n\n    sequence.effect()\n    .file(\"jb2a.fireball.explosion.orange\")\n    .atLocation(target)\n    .zIndex(1)\n\n    .sound()\n    .file(\"modules/lancer-weapon-fx/soundfx/APR2_Impact.ogg\")\n    .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n    ;\n\nsequence.play();"}
{"name":"ArcBow","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/lightning-bow.png","scope":"global","_id":"SvEgMaioDs6CiqaK","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nconst findFarthestTargetOfGroup = function (targetTokens) {\n    let farthestToken = null;\n    let farthestTokenDistance = 0;\n    targetTokens.forEach(t => {\n        let distance = canvas.grid.measureDistance(sourceToken, t);\n        if (distance > farthestTokenDistance) {\n            farthestToken = t;\n            farthestTokenDistance = distance;\n        }\n    });\n\n    return farthestToken;\n\t\n};\n\nconst farthest = findFarthestTargetOfGroup(targetTokens);\n\nfunction findNearestTargetOfGroup(targetTokens) {\n    let nearestToken = null;\n    let nearestTokenDistance = Infinity;\n    targetTokens.forEach(n => {\n        let distance = canvas.grid.measureDistance(sourceToken, n);\n        if (distance < nearestTokenDistance) {\n            nearestToken = n;\n            nearestTokenDistance = distance;\n        }\n    });\n    return nearestToken;\n};\n\nconst nearest = findNearestTargetOfGroup(targetTokens);\n\t\nconst repeatImpactAnimationForEachTarget = function (sequence, targets) {\n    targets.forEach(t => {\n        if (!targetsMissed.has(t.id)) {\n            sequence.effect()\n            .file(\"jb2a.chain_lightning.secondary\")\n            .atLocation(farthest)\n            .stretchTo(t, {randomOffset: 0.5})\n            .delay(800)\n        }\n    });\n    return sequence;\n}\n\n\nlet sequence = new Sequence()\n\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/ArcBowFire.ogg\")\n        .delay(800)\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/veil_rifle.ogg\")\n        .delay(1200)\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));\n    sequence.effect()\n        .file(\"jb2a.arrow.physical.blue\")\n        .atLocation(sourceToken)\n        .stretchTo(farthest)\n\t\t.waitUntilFinished(-1000)\n\t.effect()\n        .file(\"jb2a.chain_lightning.primary\")\n        .atLocation(sourceToken)\n        .stretchTo(farthest)\n\t\t.opacity(0.6)\n\t\t.scale(0.6);\n\nsequence = repeatImpactAnimationForEachTarget(sequence, targetTokens);\n\nsequence.play();"}
{"_id":"R006179gUEan7xqn","name":"Assault Rifle","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/ak47.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/AR_Fire.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));\n    sequence.effect()\n        .file(\"jb2a.bullet.01.orange\")\n        .atLocation(sourceToken)\n        .stretchTo(target)\n        .missed(targetsMissed.has(target.id))\n        .name(\"impact\")\n        .waitUntilFinished(-550);\n    sequence.effect()\n        .file(\"jb2a.bullet.01.orange\")\n        .atLocation(sourceToken)\n        .stretchTo(\"impact\", {randomOffset: 0.4, gridUnits: true})\n        .repeats(3, 100)\n        .waitUntilFinished();\n}\n\nsequence.play();"}
{"_id":"JDu8MtHJgZSjN6TQ","name":"AssimilationMaw","img":"modules/lancer-weapon-fx/icons/front-teeth.png","type":"script","scope":"global","author":"LancerWeaponFX00","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Melee.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));\n    sequence.effect()\n        .file(\"jb2a.bite\")\n        .atLocation(target)\n        .filter(\"ColorMatrix\", {hue: 270})\n        .filter(\"Glow\", {color: 0x8a0303, distance: 2, innerStrength: 2})\n        .zIndex(1)\n        .opacity(0.7)\n        .scaleToObject(3)\n        .waitUntilFinished(targetsMissed.has(target.id) ? 0 : -1000);\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/HeavyImpact.ogg\")\n        .playIf(!targetsMissed.has(target.id))\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7));\n    sequence.effect()\n        .file(\"jb2a.divine_smite.caster.blueyellow\")\n        .playIf(!targetsMissed.has(target.id))\n        .playbackRate(2.2)\n        .scaleToObject(1.7)\n        .filter(\"Glow\", {color: 0x8a0303, distance: 2, innerStrength: 2})\n        .filter(\"ColorMatrix\", {hue: 300})\n        .atLocation(target)\n        .waitUntilFinished(-1000);\n\n}\nsequence.play();"}
{"_id":"JMFCQVUjBc3QLBpS","name":"AutoPod","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/trefoil-shuriken.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/AutoPod_Fire.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7));\n    sequence.effect()\n        .file(\"jb2a.template_circle.vortex.loop.blue\")\n        .endTime(4700)\n        .scale(0.20)\n        .tint(\"#787878\")\n        .atLocation(sourceToken)\n        .moveTowards(target)\n        .waitUntilFinished();\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Autopod_Impact.ogg\")\n        .volume(0.7);\n    sequence.effect()\n       .file(\"jb2a.impact.yellow.1\")\n       .scale(.6)\n       .atLocation(target);\n}\nsequence.play();"}
{"_id":"DdNSH1DTIsRyJCK9","name":"BattleRifle","img":"modules/lancer-weapon-fx/icons/on-target.png","type":"script","scope":"global","author":"LancerWeaponFX00","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (let i=0; i < targetTokens.length; i++) {\n    let target = targetTokens[i];\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/BR_Fire.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n        .duration(933)\n        .delay(500)\n    .effect()\n        .file(\"jb2a.bullet.03.blue\")\n        .atLocation(sourceToken)\n        .scale(0.7)\n        .playbackRate(1.5)\n        .stretchTo(target, {randomOffset: 0.6, gridUnits: true})\n        .missed(targetsMissed.has(target.id))\n        .name('hitLocation${i}')\n        .delay(500)\n        .waitUntilFinished(-600)\n    .sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/KineticImpact.ogg\")\n        .playIf(!targetsMissed.has(target.id))\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n        .delay(150)\n    .effect()\n        .file(\"jb2a.impact.orange.0\")\n        .playIf(!targetsMissed.has(target.id))\n        .scaleToObject(1.5)\n        .atLocation('hitLocation${i}')\n        .rotateTowards(sourceToken)\n        .rotate(230)\n        .delay(150)\n        .center();\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/BR_Fire.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n        .duration(933)\n        .delay(500)\n    .effect()\n        .file(\"jb2a.bullet.03.blue\")\n        .atLocation(sourceToken)\n        .scale(0.7)\n        .playbackRate(1.5)\n        .stretchTo(target, {randomOffset: 0.6, gridUnits: true})\n        .missed(targetsMissed.has(target.id))\n        .name('hitLocation${i}')\n        .delay(500)\n        .waitUntilFinished(-600)\n    .sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/KineticImpact.ogg\")\n        .playIf(!targetsMissed.has(target.id))\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n        .delay(150)\n    .effect()\n        .file(\"jb2a.impact.orange.0\")\n        .playIf(!targetsMissed.has(target.id))\n        .scaleToObject(1.5)\n        .atLocation('hitLocation${i}')\n        .rotateTowards(sourceToken)\n        .delay(150)\n        .rotate(230)\n        .center();\n}\nsequence.play();"}
{"_id":"blc8AUjYhehKKhc5","name":"BlastPick","img":"modules/lancer-weapon-fx/icons/war-pick.png","type":"script","scope":"global","author":"LancerWeaponFX00","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\n\nfor (const target of targetTokens) {\n    sequence.effect()\n        .file(\"jb2a.melee_generic.slash.01.orange\")\n        .scaleToObject(4)\n        .atLocation(sourceToken)\n        .spriteOffset({x: -1.5}, {gridUnits:true})\n        .rotateTowards(target)\n        .delay(500)\n        .missed(targetsMissed.has(target.id))\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/bladeswing.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7))\n        .delay(500)\n        .waitUntilFinished(-1300);\n    if (!targetsMissed.has(target.id)) {\n        sequence.sound()\n            .file(\"modules/lancer-weapon-fx/soundfx/Mortar_Impact.ogg\")\n            .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7));\n        sequence.effect()\n            .file(\"jb2a.explosion.01\")\n            .scale(1)\n            .zIndex(2)\n            .atLocation(target, {randomOffset: 0.5, gridUnits: true})\n        sequence.effect()\n            .file(\"jb2a.static_electricity.03.blue\")\n            .scale(0.4)\n            .atLocation(target, {randomOffset: 1, gridUnits: true})\n            .repeats(2, 80)\n            .waitUntilFinished(-800);\n    }\n}\nsequence.play();"}
{"name":"Bolt Thrower","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/fast-arrow.png","scope":"global","_id":"6lzGhwqHNYxXY25N","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/shotgun_fire.ogg\")\n        .delay(200)\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));\n    sequence.effect()\n        .file(\"jb2a.bolt.physical.orange\")\n        .atLocation(sourceToken)\n        .startTime(500)\n        .stretchTo(target)\n        .missed(targetsMissed.has(target.id))\n        .name(\"bolt\")\n        .waitUntilFinished(-900)\n    .effect()\n        .file(\"jb2a.explosion.01.orange\")\n        .atLocation(\"bolt\");\n\n    if (!targetsMissed.has(target.id)) {\n        sequence.sound()\n            .file(\"modules/lancer-weapon-fx/soundfx/Missile_Impact.ogg\")\n            .delay(50)\n            .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));\n    }\n}\nsequence.play();"}
{"_id":"qfPYlbW1NHKOEJXF","name":"Brood Siblings Molt","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/shining-claw.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n    sequence.effect()\n        .file(\"jb2a.melee_attack.03.trail.greatsword\")\n        .tint(\"#080303\")\n\t.filter(\"Glow\", {color: 0x8f0f0f})\n        .scaleToObject(4.5)\n        .atLocation(sourceToken)\n        .moveTowards(target)\n        .missed(targetsMissed.has(target.id))\n\t.waitUntilFinished(-2500);\n\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/bladeswing.ogg\")\n        .delay(500)\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7))\n\t.waitUntilFinished(-1350);\n\n    if (!targetsMissed.has(target.id)) {\n\n        sequence.sound()\n            .file(\"modules/lancer-weapon-fx/soundfx/bladehit.ogg\")\n            .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7));\n\n        sequence.effect()\n            .file(\"jb2a.impact.blue\")\n            .scaleToObject(2)\n            .atLocation(target)\n            .waitUntilFinished(-1500);\n    }\n}\nsequence.play();"}
{"name":"Burst Launcher","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/airburst.png","scope":"global","_id":"EHls7n7amW2fEZ97","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nconst target = targetTokens[0];\n\nlet sequence = new Sequence()\n    .sound()\n    .file(\"modules/lancer-weapon-fx/soundfx/AutoPod_Fire.ogg\")\n    .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7))\n    .effect()\n    .file(\"jb2a.lightning_ball.blue\")\n    .endTime(1500)\n    .scale(0.2)\n    .atLocation(sourceToken)\n    .moveTowards(target)\n    .missed(targetsMissed.has(target.id))\n    .waitUntilFinished();\n\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/AirBurst.ogg\")\n        .playIf(!targetsMissed.has(target.id))\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n    .effect()\n        .file(\"jb2a.explosion.02.blue\")\n        .playIf(!targetsMissed.has(target.id))\n        .scale(0.5)\n        .atLocation(target)\n        .waitUntilFinished();\n\nsequence.play();"}
{"_id":"kozGi0iZPK18rFlI","name":"Charged Blade","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/shining-sword.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n    sequence.effect()\n        .file(\"jb2a.melee_attack.01.magic_sword.yellow\")\n        .filter(\"ColorMatrix\", {hue: 180})\n        .delay(500)\n        .scaleToObject(4.5)\n        .atLocation(sourceToken)\n        .moveTowards(target)\n        .waitUntilFinished(-1000)\n        .missed(targetsMissed.has(target.id));\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Axe_swing.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n        .waitUntilFinished(-1450);\n\n        sequence.sound()\n            .file(\"modules/lancer-weapon-fx/soundfx/Melee.ogg\")\n            .playIf(!targetsMissed.has(target.id))\n            .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7));\n        sequence.effect()\n            .file(\"jb2a.impact.blue.3\")\n            .playIf(!targetsMissed.has(target.id))\n            .scaleToObject(2)\n            .atLocation(target)\n            .waitUntilFinished(-1200);\n}\nsequence.play();"}
{"name":"Combat Drill","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/drill.png","scope":"global","_id":"Tyi49hWX1axZsrq2","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nlet gridsize = canvas.grid.grid.options.dimensions.size;\nlet gridscale = gridsize / 100;\n\nfor (const target of targetTokens) {\n    sequence.effect()\n        .file(\"modules/lancer-weapon-fx/sprites/DRILL.png\")\n        .scale(0.6)\n        .filter(\"Glow\", {color: 0xd7d23c})\n        .atLocation(sourceToken)\n        .spriteOffset({x: -10 * gridscale, y: 10 * gridscale})\n        .moveTowards(target)\n\t.missed(targetsMissed.has(target.id))\n        .moveSpeed(100)\n        .rotate(140)\n\n    if (!targetsMissed.has(target.id)) {\n        sequence.sound()\n            .file(\"modules/lancer-weapon-fx/soundfx/Autopod_Impact.ogg\")\n            .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7))\n            .repeats(8, 125)\n            .delay(200)\n        .effect()\n            .file(\"jb2a.gust_of_wind.veryfast\")\n            .scale(0.2)\n            .atLocation(sourceToken)\n            .moveTowards(target)\n\t\t    .zIndex(2)\n            .delay(50)\n        .effect()\n            .file(\"jb2a.impact.yellow\")\n            .scale(.4)\n            .delay(200)\n            .zIndex(1)\n            .atLocation(target, {randomOffset: 0.4})\n            .repeats(8, 125)\n            .waitUntilFinished();\n    }\n\telse {\n\t    sequence.sound()\n            .file(\"modules/lancer-weapon-fx/soundfx/Autopod_Impact.ogg\")\n            .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7))\n            .repeats(2, 170)\n            .delay(200)\n\t\t}\n}\nsequence.play();"}
{"_id":"1me7RVE8gdTnu9lk","name":"Cyclone Pulse Rifle","type":"script","author":"LancerWeaponFX00","img":"modules/JB2A_DnD5e/Library/1st_Level/Magic_Missile/MagicMissile_01_Regular_Purple_Thumb.webp","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/CPR_Fire.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n        .repeats(5, 125);\n\n    sequence.effect()\n        .file(\"jb2a.magic_missile.purple\")\n        .filter(\"ColorMatrix\", {hue: 220})\n        .atLocation(sourceToken)\n        .stretchTo(target, {randomOffset: 0.4})\n        .missed(targetsMissed.has(target.id))\n        .repeats(5, 125)\n        .waitUntilFinished(-1600);\n    if (!targetsMissed.has(target.id)) {\n        sequence.sound()\n            .file(\"modules/lancer-weapon-fx/soundfx/CPR_Impact.ogg\")\n            .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n            .repeats(5, 125)\n            .waitUntilFinished();\n    }\n}\nsequence.play();"}
{"_id":"XVCMT31Y9x5NgCf6","name":"DD 288","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/punch-blast.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n    \n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/DD288Full.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.6))\n        .waitUntilFinished(-3400);    \n    sequence.effect()\n        .file(\"jb2a.unarmed_strike.physical.01.blue\")\n\t.filter(\"ColorMatrix\", {hue: 000, brightness: 0.5})\n        .filter(\"Glow\", {distance: 3, color: 0xe99649, innerStrength: 2})\n        .atLocation(sourceToken)\n        .playbackRate(0.7)\n        .scale(8)\n        .stretchTo(target)\n        .missed(targetsMissed.has(target.id))\n        .name(\"impact\")\n        .waitUntilFinished(-650);\n\n\n        sequence.effect()\n            .file(\"jb2a.explosion_side.01.orange\")\n            .scaleToObject(6)\n            .atLocation(\"impact\")\n            .rotateTowards(sourceToken)\n            .rotate(180)\n            .spriteOffset({x: -2.9}, {gridUnits:true})\n            .zIndex(1);\n         sequence.effect()\n            .file(\"jb2a.explosion.side_fracture.flask.01\")\n            .playIf(!targetsMissed.has(target.id))\n            .scaleToObject(3)\n            .atLocation(\"impact\")\n            .rotateTowards(sourceToken)\n            .rotate(180)\n            .delay(200);\n}\nsequence.play();"}
{"_id":"JRAC43fdq4sRWQl8","name":"DefaultMelee","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/mailed-fist.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\n\nfor (const target of targetTokens) {\n    sequence.effect()\n        .file(\"jb2a.melee_generic.slash.01.orange\")\n\n        .atLocation(sourceToken)\n        .spriteOffset({x: -0.2}, {gridUnits:true})\n        .stretchTo(target)\n        .delay(500)\n        .missed(targetsMissed.has(target.id))\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/bladeswing.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7))\n        .delay(500)\n        .waitUntilFinished(-1300);\n\n        sequence.sound()\n            .file(\"modules/lancer-weapon-fx/soundfx/bladehit.ogg\")\n            .playIf(!targetsMissed.has(target.id))\n            .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7));\n        sequence.effect()\n            .file(\"jb2a.static_electricity.03.blue\")\n            .playIf(!targetsMissed.has(target.id))\n            .scaleToObject(0.5)\n            .atLocation(target, {randomOffset: 0.8, gridUnits: true})\n            .repeats(2, 80)\n            .waitUntilFinished(-2200);\n}\nsequence.play();"}
{"_id":"nCYIyBz5RESLVDdt","name":"DefaultTech","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/processor.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\ntargetTokens.forEach(target => {\n    let sequence = new Sequence()\n\n    .sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/TechPrepare.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7))\n\n    .effect()\n        .file(\"jb2a.extras.tmfx.outpulse.circle.02\")\n        .scaleToObject(2.5)\n        .filter(\"Glow\", {color: 0x36c11a})\n        .playbackRate(1.3)\n        .atLocation(sourceToken)\n\t    .waitUntilFinished(-400)\n\n    .sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/TechWarn.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7))\n\t\t\n    .effect()\n        .file(\"jb2a.extras.tmfx.inpulse.circle.02\")\n        .scaleToObject()\n        .repeats (3, 75)\n        .playbackRate(1.5)\n        .atLocation(target, {randomOffset: 0.7, gridUnits: true})\n        .filter(\"Glow\", {color: 0x36c11a})\n        .missed(targetsMissed.has(target.id))\n        .waitUntilFinished()\t\t\n\n        sequence.sound()\n            .file(\"modules/lancer-weapon-fx/soundfx/NexusConfirm.ogg\")\n            .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n            .playIf(!targetsMissed.has(target.id))\n       .effect()\n            .file(\"jb2a.zoning.inward.circle.loop\")\n\t    .playIf(!targetsMissed.has(target.id))\n            .scale(0.4)\n            .fadeOut(3800, {ease: \"easeOutBack\"})\n            .belowTokens()\n            .atLocation(target)\n            .waitUntilFinished(-2200)\n       .effect()\n            .file(\"jb2a.static_electricity\")\n            .scaleToObject(1.1)\n            .atLocation(target)\n            .playIf(!targetsMissed.has(target.id))\n\n    sequence.play();\n\t});"}
{"_id":"D8E9YpHQsJhxBLvs","name":"Designate Pinaka Area","img":"modules/lancer-weapon-fx/icons/PinakaArea.png","type":"script","scope":"global","author":"LancerWeaponFX00","command":"// This will lay down a template suitable for designating the location of a delayed Pinaka Missile strike.\n\ngame.lancer.canvas.WeaponRangeTemplate.fromRange({\n    type: \"Blast\",\n    val: 2,\n}).placeTemplate()\n    .then(t => {\n        if (t) {\n            t.update({texture: \"modules/JB2A_DnD5e/Library/Generic/Zoning/ZoningSquare01In_01_Regular_BlueGreen_Loop_600x600.webm\", distance: 1, fillColor: \"#FF0000\" });\n        };\n    }\n)"}
{"_id":"ZNQDndUit13iQDfV","name":"Designate Smoke Grenade","img":"modules/lancer-weapon-fx/icons/SmokeGrenadeArea.png","type":"script","scope":"global","author":"LancerWeaponFX00","command":"// This will lay down a template suitable for designating the location of a delayed Pinaka Missile strike.\n\ngame.lancer.canvas.WeaponRangeTemplate.fromRange({\n    type: \"Blast\",\n    val: 2.0,\n}).placeTemplate()\n    .then(t => {\n        if (t) {\n            t.update({texture: \"modules/JB2A_DnD5e/Library/Generic/Smoke/SmokePlumes01_03_Regular_Grey_400x400.webm\", distance: 1.8, fillColor: \"#756c6c\" });\n        };\n    }\n)"}
{"_id":"EiG9UfyeoHsXCX3L","name":"Designate Smoke Mine","img":"modules/lancer-weapon-fx/icons/SmokeArea.png","type":"script","scope":"global","author":"LancerWeaponFX00","command":"// This will lay down a template suitable for designating the location of a delayed Pinaka Missile strike.\n\ngame.lancer.canvas.WeaponRangeTemplate.fromRange({\n    type: \"Blast\",\n    val: 3.0,\n}).placeTemplate()\n    .then(t => {\n        if (t) {\n            t.update({texture: \"modules/JB2A_DnD5e/Library/Generic/Smoke/SmokePlumes01_03_Regular_Grey_400x400.webm\", distance: 2.8, fillColor: \"#756c6c\" });\n        };\n    }\n)"}
{"_id":"IrU7oILyUlyEecJs","name":"Displacer","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/hole.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nconst pTarget = game.modules.get(\"lancer-weapon-fx\").api.getTargetLocationsFromTokenGroup(targetTokens, 1)[0];\n\nlet sequence = new Sequence()\n\n    .sound()\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.8))\n        .file(\"modules/lancer-weapon-fx/soundfx/DisplacerFire.ogg\")\n        .startTime(900)\n        .fadeInAudio(300)\n\n    .effect()\n        .file(\"jb2a.dancing_light.purplegreen\")\n        .tint(\"#2d0a3d\")\n        .filter(\"Glow\", {strength: 1, color: 0x34e5d0})\n        .endTime(3000)\n        .scale(0.40)\n        .atLocation(sourceToken)\n        .moveTowards(pTarget)\n        .waitUntilFinished();\n\n   sequence.effect()\n        .file(\"jb2a.fumes.steam.white\")\n        .fadeIn(1500)\n        .fadeOut(1500)\n        .atLocation(sourceToken)\n        .spriteAnchor({ x: 0.2, y: 1.2 })\n        .scaleToObject()\n        .opacity(0.7);\n\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/DisplacerHit2.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.8));\n    sequence.effect()\n        .file(\"jb2a.divine_smite.caster.blueyellow\")\n        .tint(\"#2d0a3d\")\n        .filter(\"Glow\", {strength: 1, color: 0x34e5d0})\n        .scale(.9)\n        .atLocation(pTarget)\n        .waitUntilFinished(-1500);\n\n\n\nfor (let i=0; i < targetTokens.length; i++) {\n    let target = targetTokens[i];\n\n    if (!targetsMissed.has(target.id)) {\n\n\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/DisplacerHit1.ogg\")\n        .repeats(6, 200)\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.6));\n    sequence.effect()\n        .file(\"jb2a.impact.blue\")\n        .tint(\"#2d0a3d\")\n\t.filter(\"Glow\", {strength: 2, color: 0x34e5d0})\n        .scaleToObject(2)\n        .atLocation(target, {randomOffset: 0.9})\n        .repeats(6, 200);\n    }\n}\n\nsequence.play();"}
{"_id":"sdz6igpK2LGYTJfY","name":"DisruptorWhip","img":"modules/lancer-weapon-fx/icons/electric-whip.png","type":"script","scope":"global","author":"LancerWeaponFX00","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n    sequence.effect()\n        .file(\"jb2a.divine_smite.target.blueyellow\")\n        .scale(0.9)\n        .tint(\"#8c0353\")\n        .atLocation(sourceToken)\n        .moveTowards(target)\n        .moveSpeed(175)\n        .spriteOffset({x: 0, y: 100, gridUnits: true})\n        .missed(targetsMissed.has(target.id))\n        .rotate(90)\n        .delay(500)\n    .sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/bladeswing.ogg\")\n        .delay(500)\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7));\n\n    if (!targetsMissed.has(target.id)) {\n        sequence.sound()\n            .file(\"modules/lancer-weapon-fx/soundfx/bladehit.ogg\")\n            .delay(800)\n            .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7));\n        sequence.effect()\n            .file(\"jb2a.extras.tmfx.outpulse.circle.01.normal\")\n            .atLocation(target, {randomOffset: 0.7, gridUnits: true})\n            .scaleToObject(1.2)\n            .tint(\"#8c0353\")\n            .filter(\"Glow\", {color: 0x8a0303, distance: 1})\n            .repeats(3,200)\n            .playbackRate(2)\n            .belowTokens()\n            .delay(800)\n            \n        sequence.effect()\n            .file(\"jb2a.impact.001\")\n            .scaleToObject(1.2)\n            .tint(\"#8c0353\")\n            .filter(\"Glow\", {color: 0x8a0303, distance: 1})\n            .atLocation(target, {randomOffset: 0.9, gridUnits: true})\n            .repeats(6, 120)\n            .delay(1200)\n            .waitUntilFinished(-1500);\n    }\n}\nsequence.play();"}
{"_id":"Hlf1weIjm3FsVE9Z","name":"ElectricExplodeOnClick","img":"modules/lancer-weapon-fx/icons/crowned-explosion.png","type":"script","scope":"global","author":"LancerWeaponFX00","command":"//This Macro requires Warpgate module to function. When executed, the macro will play the explosion fx on the clicked location.  Useful for grenades or any other occurance where something needs to explode.\n\n\nlet config = {\n    size:2,\n    icon: 'icons/White/crowned-explosion.png',\n    label: 'EGrenade',\n    interval: 1\n}\n\nlet position = await warpgate.crosshairs.show(config);\n\nlet sequence = new Sequence()\n\n\n    .effect()\n        .file(\"jb2a.explosion.02.blue\")\n        .atLocation(position)\n        .scale(0.8)\n        .name(\"impact\")\n        .delay(500)\n        .opacity(0.8)\n    .effect()\n        .file(\"jb2a.thunderwave.center.blue\")\n        .atLocation(position)\n        .name(\"impact\")\n        .scale(0.6)\n        .delay(600)\n    .sound(\"modules/lancer-weapon-fx/soundfx/AirBurst.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7))\n        .delay(500)\n\n\n.play();"}
{"_id":"XYuNCvqqzUsq5XkK","name":"EndDefenseNet","img":"modules/lancer-weapon-fx/icons/cracked-shield.png","type":"script","scope":"global","author":"LancerWeaponFX00","command":"//This macro is not linked to any weapon or system and must be triggered manually.  Use this macro, or the Sequencer Manager, to end the 'AegisDefenseNet' effect.\n\nlet sequence = new Sequence();\n\nnew Sequence()\n    .effect(\"jb2a.shield.01.outro_explode.blue\")\n        .atLocation(token)\n        .scaleToObject(9.5)\n        .waitUntilFinished(-400)\n        .thenDo(endFX)\n.play()\n\n    function endFX() {\n        Sequencer.EffectManager.endEffects({ object: token})\n\n    }\n\nsequence.play();"}
{"_id":"BHTzvudu6KcxJI7p","name":"ExplodeOnClick","img":"modules/lancer-weapon-fx/icons/bright-explosion.png","type":"script","scope":"global","author":"LancerWeaponFX00","command":"//This Macro requires Warpgate module to function. When executed, the macro will play the explosion fx on the clicked location.  Useful for grenades or any other occurance where something needs to explode.\n\nlet config = {\n    size:1,\n    icon: 'icons/White/bright-explosion.png',\n    label: 'Grenade',\n    interval: 1\n}\n\nlet position = await warpgate.crosshairs.show(config);\n\nlet sequence = new Sequence()\n\n\n    .effect()\n        .file(\"jb2a.explosion.08.orange\")\n        .atLocation(position)\n        .name(\"impact\")\n        .delay(500)\n    .effect()\n        .file(\"jb2a.explosion.shrapnel.bomb.01.black\")\n        .atLocation(position)\n        .name(\"impact\")\n        .scale(0.6)\n        .delay(600)\n    .sound(\"modules/lancer-weapon-fx/soundfx/Missile_Impact.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7))\n        .delay(500)\n\n\n.play();"}
{"_id":"uOyi8zHzCseXGQSR","name":"Flamethrower","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/flamethrower-soldier.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nconst target = game.modules.get(\"lancer-weapon-fx\").api.getTargetLocationsFromTokenGroup(targetTokens, 1)[0];\n\nlet sequence = new Sequence()\n    .effect()\n        .file(\"jb2a.burning_hands.01.orange\")\n        .atLocation(sourceToken)\n        .rotateTowards(target)\n        .scale({x: 0.75, y: 1.0})\n        .sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/flamethrower_fire.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n        .waitUntilFinished(-3000)\n\nfor (let i=0; i < targetTokens.length; i++) {\n    let target = targetTokens[i];\n\n    if (!targetsMissed.has(target.id)) {\n        sequence.effect()\n            .file(\"jb2a.flames.02.orange\")\n            .opacity(0.7)\n            .fadeIn(800)\n            .fadeOut(800)\n            .atLocation(target)\n\t    .scaleToObject(1.2);\n    }\n}\n        sequence.play();"}
{"name":"Flechette Launcher","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/crowned-explosion.png","scope":"global","_id":"4znqR8pQvSs3KpZo","command":"const {sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence()\n    .sound()\n    .file(\"modules/lancer-weapon-fx/soundfx/Flechette.ogg\")\n    .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n    .effect()\n    .file(\"jb2a.explosion.04.blue\")\n    .playbackRate(2)\n    .atLocation(sourceToken)\n    .waitUntilFinished()\n    .effect()\n    .file(\"jb2a.impact.yellow\")\n    .scale(0.5)\n    .repeats(6, 20)\n    .atLocation(sourceToken, {randomOffset: 2.2, gridUnits: true})\n    .play();"}
{"_id":"5B4QaBx52NzRhdum","name":"Fuel Rod Gun","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/radiations.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nconst target = targetTokens[0];\n\nlet sequence = new Sequence()\n    .sound()\n    .file(\"modules/lancer-weapon-fx/soundfx/APR2_Load.ogg\")\n    .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n    .waitUntilFinished()\n    .sound()\n    .file(\"modules/lancer-weapon-fx/soundfx/APR2_Fire.ogg\")\n    .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n    .effect()\n    .file(\"jb2a.lasershot.green\")\n    .atLocation(sourceToken)\n    .stretchTo(target)\n    .missed(targetsMissed.has(target.id))\n    .scale(2.0)\n    .waitUntilFinished(-300)\nif (!targetsMissed.has(target.id)) {\n    sequence\n        .effect()\n        .file(\"jb2a.toll_the_dead.green.shockwave\")\n        .atLocation(target)\n        .scale(0.7)\n        .zIndex(1)\n        .sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/APR2_Impact.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n}\n\nsequence.play();"}
{"_id":"uIr2lCpJWXbDaowG","name":"Hammer","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/hammer-drop.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n    sequence.effect()\n        .file(\"jb2a.warhammer.melee.01.white.4\")\n        .atLocation(sourceToken)\n        .spriteOffset({x: -0.3}, {gridUnits:true})\n        .moveTowards(target)\n        .missed(targetsMissed.has(target.id))\n        .waitUntilFinished(-1400);\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Axe_swing.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7))\n        .waitUntilFinished(-1800);\n    if (!targetsMissed.has(target.id)) {\n        sequence.sound()\n            .file(\"modules/lancer-weapon-fx/soundfx/HammerImpact.ogg\")\n            .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.9));\n        sequence.effect()\n            .file(\"jb2a.impact.ground_crack.orange\")\n            .atLocation(target)\n            .belowTokens()\n            .scaleToObject(3)\n            .waitUntilFinished(-6000);\n    }\n}\nsequence.play();"}
{"_id":"X6m0372eLE56NK6l","name":"HMG","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/machine-gun.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/AssaultCannonFire.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));\n    sequence.effect()\n        .file(\"jb2a.bullet.01.orange\")\n        .atLocation(sourceToken)\n        .stretchTo(target)\n        .missed(targetsMissed.has(target.id))\n        .name(\"impact\")\n        .scale(0.5)\n        .waitUntilFinished(-500);\n    sequence.effect()\n        .file(\"jb2a.bullet.01.orange\")\n        .atLocation(sourceToken)\n        .stretchTo(\"impact\", {randomOffset: 0.4, gridUnits: true})\n        .repeats(7, 50)\n        .scale(0.5)\n        .waitUntilFinished();\n}\n\nsequence.play();"}
{"name":"Impact Lance","type":"script","author":"LancerWeaponFX00","img":"modules/JB2A_DnD5e/Library/6th_Level/Disintegrate/Disintegrate_01_Regular_Green01_Thumb.webp","scope":"global","_id":"gciDprfhVSDqYDPd","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Annihilator_Charge.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));\n    sequence.effect()\n        .file(\"jb2a.disintegrate.green\")\n        .startTime(900)\n        .scale(.86)\n        .atLocation(sourceToken)\n        .stretchTo(target)\n        .missed(targetsMissed.has(target.id))\n        .waitUntilFinished(-4000)\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Annihilator.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));;\n    if (!targetsMissed.has(target.id)) {\n        sequence.effect()\n            .file(\"jb2a.impact.blue.3\")\n            .scaleToObject(2)\n            .atLocation(target)\n            .waitUntilFinished(-400);\n    }\n}\nsequence.play();"}
{"_id":"WjxNFb3JQBla9BBC","name":"JetLancerExplosion","img":"modules/lancer-weapon-fx/icons/explosion-rays.png","type":"script","scope":"global","author":"fpthefluffypawed","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nnew Sequence()\n\t.sound(\"modules/lancer-weapon-fx/soundfx/dramaticSparkles.ogg\")\n\t\t.fadeInAudio(4000)\n\t\t.volume(0.3)\n\t\t.duration(5000)\n\t.effect(\"jb2a.static_electricity.03.blue\")\n\t\t.atLocation(sourceToken)\n\t\t.scaleToObject(1)\n\t\t.duration(5000)\n\t.canvasPan()\n\t\t.atLocation(sourceToken)\n\t\t.duration(5000)\n\t\t.scale(1)\n\t\t.waitUntilFinished()\n\t.canvasPan()\n\t\t.atLocation(sourceToken)\n\t\t.duration(100)\n\t\t.scale(2)\n\t.sound(\"modules/lancer-weapon-fx/soundfx/jetlancerSound.ogg\")\n\t.effect(\"modules/lancer-weapon-fx/video/jetlancer_explosion_1000.webm\")\n\t\t.aboveInterface()\n\t\t.atLocation(sourceToken)\n\t\t.scale(1)\n\t.canvasPan()\n\t\t.shake({duration: 5000, strength: 10, rotation: false, fadeOutDuration: 500})\n\t\t.thenDo(remainsAftermath)\n\t\t.waitUntilFinished()\n\t.effect(\"modules/lancer-weapon-fx/sprites/jetlancer_explosion_white_bg.png\")\n\t\t.delay(3600)\n\t\t.aboveInterface()\n\t\t.atLocation(sourceToken)\n\t\t.duration(1700)\n\t\t.fadeOut(300)\n\t.play()\n\nfunction remainsAftermath() {\n\tconsole.log(\"AFTERMATH\");\n\tconsole.log(sourceToken);\n\tconsole.log(canvas)\n\ttoken.document.update({hidden: true});\n\tcanvas.scene.createEmbeddedDocuments(\"Tile\", [{ \n\t\ttexture: { src: \"modules/lancer-weapon-fx/sprites/RETROGRADE-crater.png\" }, \n\t\tx: token.document.x - canvas.dimensions.size,\n\t\ty: token.document.y - (canvas.dimensions.size + (canvas.dimensions.size / 2)),\n\t\theight: canvas.dimensions.size * (token.document.width + 2),\n\t\twidth: canvas.dimensions.size * (token.document.width + 2),\n\t\ttint: \"#464646\"\n\t }]);\n}\n\n\n\nsequence.play();"}
{"_id":"eyeOAl8lFp0w3Hfd","name":"Kraul Rifle","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/harpoon-chain.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nconst target = targetTokens[0];\n\nlet sequence = new Sequence()\n    .sound()\n    .file(\"modules/lancer-weapon-fx/soundfx/AMR_Fire.ogg\")\n    .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n    .effect()\n    .file(\"jb2a.bullet.Snipe.blue\")\n    .tint(\"#9d9595\")\n    .atLocation(sourceToken)\n    .stretchTo(target)\n    .missed(targetsMissed.has(target.id))\n    .waitUntilFinished(-1200)\nif (!targetsMissed.has(target.id)) {\n    sequence\n        .effect()\n        .file(\"jb2a.impact.orange.0\")\n        .atLocation(target)\n        .rotateTowards(sourceToken)\n        .rotate(230)\n        .center()\n        .sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/AMR_Impact.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n}\n\nsequence.play();"}
{"_id":"hWPrLPzlj6Y5RvC5","name":"Lasers","type":"script","author":"LancerWeaponFX00","img":"modules/JB2A_DnD5e/Library/Generic/Weapon_Attacks/Ranged/LaserShot_01_Regular_Blue_Thumb.webp","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nconst random = Sequencer.Helpers.random_float_between(200, 300);\n\nlet sequence = new Sequence();\n\nfor (let i=0; i < targetTokens.length; i++) {\n    let target = targetTokens[i];\n\tsequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Laser_Fire.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n\t\t.duration(633)\n        .repeats(3, random);\n\tsequence.effect()\n        .file(\"jb2a.impact.blue.2\")\n\t\t.playIf(!targetsMissed.has(target.id))\n        .atLocation(`impact${i}`)\n        .scaleToObject(2)\n        .repeats(3, random)\n\t\t.delay(300);\n    sequence.effect()\n        .file(\"jb2a.lasershot.blue\")\n        .atLocation(sourceToken)\n        .stretchTo(target, {randomOffset: 0.4})\n        .missed(targetsMissed.has(target.id))\n\t    .name(`impact${i}`)\n        .repeats(3, random)\n\t\t.waitUntilFinished();\n}\nsequence.play();"}
{"_id":"zf87PAIPccMpxnYn","name":"Latch Drone","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/LatchDrone.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n    sequence.effect()\n        .file(\"modules/lancer-weapon-fx/sprites/LatchDrone.png\")\n        .rotate(260)\n        .atLocation(sourceToken)\n        .rotateTowards(target)\n        .moveTowards(target)\n        .missed(targetsMissed.has(target.id))\n        .moveSpeed(1200);\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Mortar_Launch.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7))\n        .waitUntilFinished()\n    if (!targetsMissed.has(target.id)) {\n        sequence\n            .sound()\n            .file(\"modules/lancer-weapon-fx/soundfx/Stabilize.ogg\")\n            .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.9))\n            .delay(200)\n            .effect()\n            .file(\"jb2a.healing_generic.400px.green\")\n            .atLocation(target)\n            .scale(0.5)\n            .delay(200)\n            .waitUntilFinished();\n    }\n}\nsequence.play();"}
{"_id":"UhdlCUxGv5UJGPQG","name":"Leviathan","img":"modules/lancer-weapon-fx/icons/machine-gun.png","type":"script","scope":"global","author":"LancerWeaponFX00","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Leviathan.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));\n    sequence.effect()\n        .file(\"jb2a.bullet.01.orange\")\n        .atLocation(sourceToken)\n        .stretchTo(target, {randomOffset: 0.3})\n        .missed(targetsMissed.has(target.id))\n        .name(\"impact\")\n        .scale(0.5)\n\t.waitUntilFinished(-575)\n    sequence.effect()\n        .file(\"jb2a.bullet.01.orange\")\n        .atLocation(sourceToken)\n        .stretchTo(\"impact\", {randomOffset: 0.6, gridUnits: true})\n        .repeats(9, 30)\n        .scale(0.5)\n        .waitUntilFinished();\n}\n\nsequence.play();"}
{"name":"LockOn","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/crosshair.png","scope":"global","_id":"k5UDriYBR2pnAUjn","command":"const {targetTokens} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/LockOn.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.8));\n    sequence.effect()\n        .file(\"jb2a.zoning.inward.square.loop.bluegreen.01.01\")\n        .atLocation(target)\n        .scaleToObject(1.6);\n}\n\nsequence.play();"}
{"_id":"4M655uuaKwHfZJfZ","name":"Missile","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/missile-swarm.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nconst target = game.modules.get(\"lancer-weapon-fx\").api.getTargetLocationsFromTokenGroup(targetTokens, 1)[0];\n\n\nlet sequence = new Sequence()\n\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Missile_Launch.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Missile_Travel.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n        .timeRange(700, 2000);\n    sequence.effect()\n        .file(\"jb2a.pack_hound_missile\")\n        .atLocation(sourceToken)\n        .stretchTo(target)\n        .waitUntilFinished(-3200);\n    sequence.effect()\n         .file(\"jb2a.explosion.01.orange\")\n         .atLocation(target)\n         .scale(1.2)\n         .zIndex(1)\n         .waitUntilFinished(-1300);\n\n    if (!targetsMissed.has(target.id)) {\n        sequence.sound()\n            .file(\"modules/lancer-weapon-fx/soundfx/Missile_Impact.ogg\")\n            .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));\n\n    }\nsequence.play();"}
{"_id":"1ntDWMtnxAA1uZMH","name":"MissileAirBurst","img":"modules/lancer-weapon-fx/icons/incoming-rocket.png","type":"script","scope":"global","author":"LancerWeaponFX00","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nconst pTarget = game.modules.get(\"lancer-weapon-fx\").api.getTargetLocationsFromTokenGroup(targetTokens, 1)[0];\n\n// Calculate the point 70% of the distance between sourceToken and pTarget\nconst pBlast = {\n    x: sourceToken.position.x + 0.6 * (pTarget.x - sourceToken.position.x),\n    y: sourceToken.position.y + 0.6 * (pTarget.y - sourceToken.position.y),\n};\n\n\nlet sequence = new Sequence()\n\n\n    .sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Missile_Launch.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n    .sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Missile_Travel.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n        .timeRange(700, 2000);\n    sequence.effect()\n        .file(\"jb2a.throwable.launch.missile\")\n        .scale(0.7)\n        .from(sourceToken)\n        .stretchTo(pBlast)\n        .waitUntilFinished(-200)\n    .effect()\n         .file(\"jb2a.explosion.08\")\n         .atLocation(pBlast)\n         .name(\"impact\")\n         .scale(0.8)\n         .zIndex(1)\n    .sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Flechette.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n\nfor (let i=0; i < targetTokens.length; i++) {\n    let target = targetTokens[i];\n\n    sequence.effect()\n        .file(\"jb2a.bullet.02.orange\")\n\t.playIf(!targetsMissed.has(target.id))\n         .scale(0.5)\n\t .atLocation(pBlast)\n\t .stretchTo(target)\n    .effect()\n        .file(\"jb2a.explosion_side.01\")\n\t.playIf(!targetsMissed.has(target.id))\n        .atLocation(target)\n\t.rotateTowards(pBlast)\n\t.center()\n        .delay(350)\n    .sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Missile_Impact.ogg\")\n        .playIf(!targetsMissed.has(target.id))\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n\t.delay(350);\n}\nsequence.play();"}
{"_id":"HOn4Xub4x5q0AmPw","name":"MissileAoE","img":"modules/lancer-weapon-fx/icons/rocket.png","type":"script","scope":"global","author":"LancerWeaponFX00","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nconst target = game.modules.get(\"lancer-weapon-fx\").api.getTargetLocationsFromTokenGroup(targetTokens, 1)[0];\n\n\nlet sequence = new Sequence()\n\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Missile_Launch.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Missile_Travel.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n        .timeRange(700, 2000);\n    sequence.effect()\n        .file(\"jb2a.pack_hound_missile\")\n        .atLocation(sourceToken)\n        .stretchTo(target)\n        .waitUntilFinished(-3200);\n    sequence.effect()\n         .file(\"jb2a.explosion.01.orange\")\n         .atLocation(target)\n         .scale(1.2)\n         .zIndex(1)\n         .waitUntilFinished(-1300);\n\n    if (!targetsMissed.has(target.id)) {\n        sequence.sound()\n            .file(\"modules/lancer-weapon-fx/soundfx/Missile_Impact.ogg\")\n            .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));\n\n    }\nsequence.play();"}
{"_id":"nigj4bbJZOVrFf0u","name":"MissilePinaka","img":"modules/lancer-weapon-fx/icons/rocket.png","type":"script","scope":"global","author":"LancerWeaponFX00","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\n// Pinaka wants 2 missiles, so get 2 groups\nconst targetPoints = game.modules.get(\"lancer-weapon-fx\").api.getTargetLocationsFromTokenGroup(targetTokens, 2);\n\nlet sequence = new Sequence();\n\nfor (const targetPoint of targetPoints) {\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Missile_Launch.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Missile_Travel.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n        .timeRange(700, 2000);\n    sequence.effect()\n        .file(\"jb2a.throwable.launch.missile\")\n        .atLocation(sourceToken)\n        .stretchTo(targetPoint)\n        .waitUntilFinished();\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Missile_Impact.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));\n    sequence.effect()\n        .file(\"jb2a.explosion.01.orange\")\n        .atLocation(targetPoint)\n        .scale(1.2)\n        .zIndex(2);\n    sequence.effect()\n        .file(\"jb2a.explosion.08.orange\")\n        .atLocation(targetPoint)\n        .scale(1.2)\n        .zIndex(1);\n}\nsequence.play();"}
{"_id":"bfFuD6eL09TcBLIN","name":"Missiles","img":"modules/lancer-weapon-fx/icons/missile-swarm.png","type":"script","scope":"global","author":"LancerWeaponFX00","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\nfor (let i=0; i < targetTokens.length; i++) {\n    let target = targetTokens[i];\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Missile_Launch.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Missile_Travel.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n        .timeRange(700, 2000);\n    sequence.effect()\n        .file(\"jb2a.pack_hound_missile\")\n        .atLocation(sourceToken)\n        .stretchTo(target)\n        .missed(targetsMissed.has(target.id))\n        .name(`impact${i}`)\n        .waitUntilFinished(-3200);\n    sequence.effect()\n         .file(\"jb2a.explosion.01.orange\")\n         .atLocation(`impact${i}`)\n         .scale(0.8)\n         .zIndex(1)\n         .waitUntilFinished(-1300);\n\n    if (!targetsMissed.has(target.id)) {\n        sequence.sound()\n            .file(\"modules/lancer-weapon-fx/soundfx/Missile_Impact.ogg\")\n            .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n\t\t\t.waitUntilFinished(-8000);\n\n    }\n}\nsequence.play();"}
{"_id":"sSGstellhxzWUTXd","name":"Mortar","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/mortar.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nconst centerMass = game.modules.get(\"lancer-weapon-fx\").api.getTargetLocationsFromTokenGroup(targetTokens, 1)[0];\n\nconst repeatImpactAnimationForEachTarget = function (sequence, targetTokens) {\n    targetTokens.forEach(t => {\n        if (!targetsMissed.has(t.id)) {\n            sequence.effect()\n                .file(\"jb2a.explosion_side.01.orange\")\n                .atLocation(t)\n                .rotateTowards(centerMass)\n                .scale(0.7)\n                .center()\n        }\n    });\n    return sequence;\n}\n\nlet sequence = new Sequence();\n\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Mortar_Launch.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));\n    sequence.effect()\n        .file(\"jb2a.smoke.puff.side.02.white\")\n        .atLocation(sourceToken)\n        .rotateTowards(centerMass)\n        .scale({y: 0.5});\n\tsequence.effect()\n        .file(\"jb2a.bullet.02.orange\")\n        .atLocation(sourceToken)\n        .stretchTo(centerMass)\n\t.playbackRate(0.7)\n\t.waitUntilFinished(-650)\n\n    sequence.effect()\n        .file(\"jb2a.explosion.shrapnel.bomb.01.black\")\n        .atLocation(centerMass)\n        .scale(0.5);\n    sequence.effect()\n        .file(\"jb2a.explosion.08.orange\")\n        .atLocation(centerMass)\n\t.rotateTowards(sourceToken)\n        .rotate(180)\n        .center();\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Mortar_Impact.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));\n\nsequence = repeatImpactAnimationForEachTarget(sequence, targetTokens);\n\nsequence.play();"}
{"_id":"jHll38UQ9hHzwsf3","name":"Nanobot Whip","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/electric-whip.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n    sequence.effect()\n        .file(\"jb2a.divine_smite.target.blueyellow\")\n        .scale(0.9)\n        .tint(\"#066605\")\n        .atLocation(sourceToken)\n        .moveTowards(target)\n        .moveSpeed(175)\n        .spriteOffset({x: 0, y: 100, gridUnits: true})\n        .missed(targetsMissed.has(target.id))\n        .rotate(90)\n        .delay(500)\n    .sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/bladeswing.ogg\")\n        .delay(500)\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7));\n\n    if (!targetsMissed.has(target.id)) {\n        sequence.sound()\n            .file(\"modules/lancer-weapon-fx/soundfx/bladehit.ogg\")\n            .delay(800)\n            .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7));\n        sequence.effect()\n            .file(\"jb2a.impact.blue\")\n            .scale(0.5)\n            .tint(\"#066605\")\n            .atLocation(target, {randomOffset: 1})\n            .repeats(4, 80)\n            .delay(1200)\n            .waitUntilFinished(-1500);\n    }\n}\nsequence.play();"}
{"_id":"Aj3QspxsjcnNjfol","name":"Needle Beam","type":"script","author":"LancerWeaponFX00","img":"modules/JB2A_DnD5e/Library/Generic/Weapon_Attacks/Ranged/LaserShot_01_Regular_Green_Thumb.webp","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Annihilator_Charge.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n        .waitUntilFinished(-1200)\n    .sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Plasma_Fire.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n        .repeats(2, 225)\n\n    .effect()\n        .file(\"jb2a.lasershot.green\")\n        .atLocation(sourceToken)\n        .stretchTo(target)\n        .missed(targetsMissed.has(target.id))\n        .repeats(2, 225)\n        .waitUntilFinished(-350)\n;\n    if (!targetsMissed.has(target.id)) {\n        sequence.effect()\n            .file(\"jb2a.impact.orange.0\")\n            .atLocation(target)\n            .rotateTowards(sourceToken)\n            .rotate(230)\n            .center()\n            .tint(\"#1aff34\")\n            .scale(0.8);\n    }\n}\nsequence.play();"}
{"_id":"RmFiCRMoSOku7G5g","name":"Nexus","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/nano-bot.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nconst pTarget = game.modules.get(\"lancer-weapon-fx\").api.getTargetLocationsFromTokenGroup(targetTokens, 1)[0];\n\n// Calculate the point 70% of the distance between sourceToken and pTarget\nconst pBlast = {\n    x: sourceToken.position.x + 0.7 * (pTarget.x - sourceToken.position.x),\n    y: sourceToken.position.y + 0.7 * (pTarget.y - sourceToken.position.y),\n};\n\n\nlet sequence = new Sequence()\n\n\t.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/NexusReady.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n        .waitUntilFinished();\n\tsequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/NexusFire.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n        .repeats(3, 150);\n    sequence.effect()\n        .file(\"jb2a.bullet.01.orange\")\n        .filter(\"ColorMatrix\", {hue: 070})\n        .filter(\"Blur\", {blur: 8, strength: 10, blurX: 4})\n        .atLocation(sourceToken)\n        .stretchTo(pBlast, {randomOffset: 0.6})\n        .repeats(3, 150)\n        .waitUntilFinished(-800);\n    sequence.effect()\n        .file(\"jb2a.side_impact.part.smoke.blue\")\n        .filter(\"ColorMatrix\", {hue: 230, brightness: 0.5})\n        .scale(0.8)\n        .atLocation(pBlast, {randomOffset: 0.1})\n\t.rotateTowards(pTarget)\n        .repeats(3, 150)\n        .waitUntilFinished(-2200);\n\nfor (let i=0; i < targetTokens.length; i++) {\n    let target = targetTokens[i];\n\n    sequence.effect()\n        .file(\"jb2a.impact.004.blue\")\n       .playIf(!targetsMissed.has(target.id))\n        .filter(\"ColorMatrix\", {hue: 235, brightness: 0.5})\n        .scale(0.5)\n\t.zIndex(1)\n        .atLocation(target, {randomOffset: 0.5, gridUnits: true})\n        .repeats(3, 100);\n    sequence.effect()\n        .file(\"jb2a.zoning.inward.circle.loop\")\n\t.playIf(!targetsMissed.has(target.id))\n        .scale(0.4)\n        .fadeOut(3800, {ease: \"easeOutBack\"})\n        .belowTokens()\n        .atLocation(target);\n    sequence.sound()\n\t.file(\"modules/lancer-weapon-fx/soundfx/NexusConfirm.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n        .playIf(!targetsMissed.has(target.id));\n}\nsequence.play();"}
{"_id":"Nsmpx88frJTCU0Ax","name":"NuclearExplosionSFC","img":"modules/lancer-weapon-fx/icons/mushroom-cloud.png","type":"script","scope":"global","author":"fpthefluffypawed","command":"new Sequence()\n\t.effect(\"modules/lancer-weapon-fx/sprites/jetlancer_explosion_white_bg.png\")\n\t\t.fadeIn(100)\n\t\t.duration(6000)\n\t\t.fadeOut(3000)\n\t\t.screenSpace()\n\t.effect(\"modules/lancer-weapon-fx/sprites/shockwave.png\")\n\t\t.atLocation(token)\n\t\t.duration(7000)\n\t\t.scale(0.2)\n\t\t.scaleOut(12, 7000)\n\t\t.fadeOut(7000)\n\t\t.delay(3000)\n\t.sound(\"modules/lancer-weapon-fx/soundfx/pw_nuke.ogg\")\n\t\t.startTime(800)\n\t\t.delay(1000)\n\t.effect(\"modules/lancer-weapon-fx/video/pw_nuke_effect.webm\")\n\t\t.delay(1000)\n\t\t.atLocation(token)\n\t\t.aboveLighting()\n\t\t.xray()\n\t\t.scale(1)\n\t\t.zIndex(100)\n\t\t.thenDo(remainsAftermath)\n\t/*\n\t\tCRATER EFFECT PERSISTENT AFTERWARDS:\n\t\t- Both following effects are entirely for the crater, remove\n\t\t- or comment it out as needed. Light included.\n\t*/\n\t.effect(\"jb2a.ground_cracks.01.orange\")\n\t\t.persist()\n\t\t.belowTokens()\n\t\t.aboveLighting()\n\t\t.zIndex(1)\n\t\t.xray()\n\t\t.randomRotation()\n\t\t.atLocation(token)\n\t\t.scale(2)\n\t\t.thenDo(createLight)\n\t.effect(\"modules/lancer-weapon-fx/sprites/scorch_mark_hires.png\")\n\t\t.atLocation(token)\n\t\t.scale(2.2)\n\t\t.persist()\n\t\t.belowTokens()\n\t\t.zIndex(0)\n\t\t.randomRotation()\n\t\t.xray()\n\t.canvasPan()\n\t\t.delay(1000)\n        .atLocation(token)\n        .scale(0.5)\n\t\t.shake({\n\t\t\tduration: 20000,\n\t\t\tstrength: 15,\n\t\t\tfadeOutDuration: 10000,\n\t\t\trotation: true\n\t\t})\n.play()\n\nasync function remainsAftermath() {\n\tconsole.log(\"AFTERMATH\");\n\ttoken.document.update({hidden: true});\n}\n\nasync function createLight() {\n\tawait canvas.scene.createEmbeddedDocuments(\"AmbientLight\", [{\n\t\tx: token.document.x + (canvas.dimensions.size / 2),\n\t\ty: token.document.y +  (canvas.dimensions.size / 2),\n\t\tconfig: {\n\t\t\tcolor: \"#ff9117\",\n\t\t\tdim: 10,\n\t\t\tbright: 5,\n\t\t\tanimation: {\n\t\t\t\ttype: \"pulse\",\n\t\t\t},\n\t\t}\n\t}]);\n}"}
{"_id":"tzS44LYDm9vRB0HP","name":"NuclearExplosionSpace","img":"modules/lancer-weapon-fx/icons/mushroom-cloud.png","type":"script","scope":"global","author":"fpthefluffypawed","command":"new Sequence()\n\t.effect(\"modules/lancer-weapon-fx/sprites/jetlancer_explosion_white_bg.png\")\n\t\t.fadeIn(100)\n\t\t.duration(6000)\n\t\t.fadeOut(3000)\n\t\t.screenSpace()\n\t.effect(\"modules/lancer-weapon-fx/sprites/shockwave.png\")\n\t\t.atLocation(token)\n\t\t.duration(7000)\n\t\t.scale(0.2)\n\t\t.scaleOut(12, 7000)\n\t\t.fadeOut(7000)\n\t\t.delay(3000)\n\t.sound(\"modules/lancer-weapon-fx/soundfx/pw_nuke.ogg\")\n\t\t.startTime(800)\n\t\t.delay(1000)\n\t.effect(\"modules/lancer-weapon-fx/video/pw_nuke_effect.webm\")\n\t\t.delay(1000)\n\t\t.atLocation(token)\n\t\t.aboveLighting()\n\t\t.xray()\n\t\t.scale(1)\n\t\t.zIndex(100)\n\t\t.thenDo(remainsAftermath)\n\t.canvasPan()\n\t\t.delay(1000)\n        .atLocation(token)\n        .scale(0.5)\n\t\t.shake({\n\t\t\tduration: 20000,\n\t\t\tstrength: 15,\n\t\t\tfadeOutDuration: 10000,\n\t\t\trotation: true\n\t\t})\n.play()\n\nasync function remainsAftermath() {\n\tconsole.log(\"AFTERMATH\");\n\ttoken.document.update({hidden: true});\n}\n\nasync function createLight() {\n\tawait canvas.scene.createEmbeddedDocuments(\"AmbientLight\", [{\n\t\tx: token.document.x + (canvas.dimensions.size / 2),\n\t\ty: token.document.y +  (canvas.dimensions.size / 2),\n\t\tconfig: {\n\t\t\tcolor: \"#ff9117\",\n\t\t\tdim: 10,\n\t\t\tbright: 5,\n\t\t\tanimation: {\n\t\t\t\ttype: \"pulse\",\n\t\t\t},\n\t\t}\n\t}]);\n}"}
{"_id":"OSMfNiiu5XtzacAJ","name":"Pistol","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/pistol-gun.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nconst random = Sequencer.Helpers.random_float_between(200, 500);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/pistol_fire.ogg\")\n        .repeats(3, random)\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));\n    sequence.effect()\n        .file(\"jb2a.bullet.01.orange\")\n        .atLocation(sourceToken)\n        .scale(0.5)\n        .stretchTo(target, {randomOffset: 0.4})\n        .missed(targetsMissed.has(target.id))\n        .repeats(3, random)\n        .waitUntilFinished(-600);\n}\nsequence.play();"}
{"name":"Plasma Maul","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/hammer-drop.png","scope":"global","_id":"gBqPs99uLDUAroZu","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\n\nfor (const target of targetTokens) {\n    sequence.effect()\n        .file(\"jb2a.warhammer.melee.01.white.4\")\n        .filter(\"Glow\", {color: 0x18f014, innerStrength: 1.5, knockout: true, quality: 0.1, distance: 50})\n\t.tint(\"#18f014\")\n        .atLocation(sourceToken)\n        .spriteOffset({x: -0.3}, {gridUnits:true})\n        .moveTowards(target)\n        .missed(targetsMissed.has(target.id))\n\t\t.waitUntilFinished(-1400);\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Axe_swing.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7))\n\t\t.waitUntilFinished(-1800);\n    if (!targetsMissed.has(target.id)) {\n        sequence.sound()\n            .file(\"modules/lancer-weapon-fx/soundfx/HammerImpact.ogg\")\n            .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.9));\n        sequence.effect()\n            .file(\"jb2a.impact.ground_crack.orange\")\n\t        .tint(\"#18f014\")\n            .atLocation(target)\n            .belowTokens()\n            .scaleToObject(3)\n            .waitUntilFinished(-6000);\n    }\n}\nsequence.play();"}
{"_id":"noDQfz2lYaqIc1ii","name":"Plasma Rifle","type":"script","author":"LancerWeaponFX00","img":"modules/JB2A_DnD5e/Library/Generic/Weapon_Attacks/Ranged/LaserShot_01_Regular_Green_Thumb.webp","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nconst random = Sequencer.Helpers.random_float_between(300, 400);\n\nlet sequence = new Sequence();\n\nfor (let i=0; i < targetTokens.length; i++) {\n    let target = targetTokens[i];\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Plasma_Fire.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n        .duration(633)\n        .repeats(2, random);\n    sequence.effect()\n        .file(\"jb2a.impact.004.blue\")\n        .playIf(!targetsMissed.has(target.id))\n        .atLocation(`impact${i}`)\n        .tint(\"#1aff34\")\n        .scaleToObject(2)\n        .repeats(2, random)\n        .delay(300)\n        .playbackRate(1.5);\n    sequence.effect()\n        .file(\"jb2a.lasershot.green\")\n        .atLocation(sourceToken)\n        .stretchTo(target, {randomOffset: 0.3, gridUnits: true})\n        .missed(targetsMissed.has(target.id))\n\t.name(`impact${i}`)\n        .repeats(2, random)\n        .waitUntilFinished();\n\n\n}\nsequence.play();"}
{"_id":"ui1a07lCGBOk4Rp7","name":"Plasma Talons","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/claw-slashes.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n\n    sequence.effect()\n        .file(\"jb2a.claws.400px.red\")\n        .tint(\"#720d87\")\n        .scale(0.8)\n        .zIndex(1)\n        .opacity(0.6)\n        .atLocation(target)\n        .missed(targetsMissed.has(target.id));\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Melee.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n        .repeats(2, 250);\n    if (!targetsMissed.has(target.id)) {\n        sequence.effect()\n            .file(\"jb2a.impact.blue.2\")\n            .scale(1.0)\n            .tint(\"#c91af9\")\n            .atLocation(target, {randomOffset:0.1|true})\n            .delay(200)\n            .repeats(2, 250);\n    }\n}\nsequence.play();"}
{"_id":"e5XwWrHsiRKrgh7S","name":"Plasma Thrower","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/lightning-flame.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nconst target = game.modules.get(\"lancer-weapon-fx\").api.getTargetLocationsFromTokenGroup(targetTokens, 1)[0];\n\nlet sequence = new Sequence()\n\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/flamethrower_fire.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n    sequence.effect()\n        .file(\"jb2a.breath_weapons02.burst.cone.fire.orange.02\")\n        .atLocation(sourceToken)\n\t.filter(\"ColorMatrix\", {hue: 270})\n        .filter(\"Glow\", {distance: 3, color: 0xe99649, innerStrength: 2})\n        .scale({x: 0.9})\n        .playbackRate(1.6)\n        .rotateTowards(target)\n        .waitUntilFinished(-3500);\n\nfor (let i=0; i < targetTokens.length; i++) {\n    let target = targetTokens[i];\n\n    if (!targetsMissed.has(target.id)) {\n        sequence.effect()\n            .file(\"jb2a.flames.02.orange\")\n\t    .filter(\"ColorMatrix\", {hue: 270})\n            .filter(\"Glow\", {distance: 3, color: 0xe99649, innerStrength: 2})\n            .opacity(0.7)\n            .fadeIn(800)\n            .fadeOut(800)\n            .atLocation(target)\n\t    .scaleToObject(1.2);\n    }\n}\n    sequence.play();"}
{"_id":"UL0licrIIu44WXnO","name":"Plasma Torch","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/laserburn.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nconst target = targetTokens[0];\n\nlet sequence = new Sequence()\n    .effect()\n    .file(\"jb2a.fire_jet.orange\")\n    .atLocation(sourceToken)\n    .stretchTo(target)\n    .sound()\n    .file(\"modules/lancer-weapon-fx/soundfx/flamethrower_fire.ogg\")\n    .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n    .play();"}
{"_id":"7S31ONuehIUe8R0Q","name":"PlasmaProjector","img":"modules/JB2A_DnD5e/Library/6th_Level/Disintegrate/Disintegrate_01_Regular_Green01_Thumb.webp","type":"script","scope":"global","author":"LancerWeaponFX00","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nconst target = targetTokens[0];\n\nnew Sequence()\n\n    .canvasPan()\n        .duration(1000)\n        .atLocation(sourceToken)\n        .scale(0.25)\n    .effect()\n        .file(\"jb2a.disintegrate.green\")\n        .delay(1000)\n        .startTime(1)\n        .scale(2)\n        .playbackRate(0.6)\n        .filter(\"Glow\", {distance: 3, color: 0x98ec5f, innerStrength: 2})\n        .atLocation(sourceToken)\n        .stretchTo(target)\n        .waitUntilFinished(-3400)\n    .canvasPan()\n\t.duration(2000)\n        .atLocation(target)\n        .scale(0.4)\n        .waitUntilFinished(-500)\n    .effect()\n        .file(\"jb2a.impact.blue\")\n        .filter(\"ColorMatrix\", {hue: 270})\n        .scaleToObject()\n        .atLocation(target, {randomOffset: 1.2, gridUnits: true})\n        .repeats(10, 200, 700)\n        .waitUntilFinished(-500)\n\t.effect(\"modules/lancer-weapon-fx/sprites/jetlancer_explosion_white_bg.png\")\n\t\t.fadeIn(100)\n\t\t.duration(6000)\n\t\t.fadeOut(3000)\n\t\t.screenSpace()\n\t.effect(\"modules/lancer-weapon-fx/sprites/shockwave.png\")\n\t\t.atLocation(target)\n        .filter(\"ColorMatrix\", {hue: 090})\n\t\t.duration(7000)\n\t\t.scale(0.2)\n\t\t.scaleOut(12, 7000)\n\t\t.fadeOut(7000)\n\t\t.delay(3000)\n\t.sound(\"modules/lancer-weapon-fx/soundfx/pw_nuke.ogg\")\n\t\t.startTime(800)\n\t\t.delay(1000)\n\t.effect(\"modules/lancer-weapon-fx/video/pw_nuke_effect.webm\")\n        .filter(\"ColorMatrix\", {hue: 090})\n\t\t.delay(1000)\n\t\t.atLocation(target)\n\t\t.aboveLighting()\n\t\t.xray()\n\t\t.scale(1)\n\t\t.zIndex(100)\n\t\t.thenDo(remainsAftermath)\n\t.canvasPan()\n\t\t.delay(1000)\n        .atLocation(target)\n        .scale(0.5)\n\t\t.shake({\n\t\t\tduration: 20000,\n\t\t\tstrength: 15,\n\t\t\tfadeOutDuration: 10000,\n\t\t\trotation: true\n\t\t})\n\n.play();\n\nfunction remainsAftermath() {\n\tconsole.log(\"AFTERMATH\");\n\ttargetTokens[0].document.update({hidden: true});\n}"}
{"_id":"oGArtZBtIRBcRHCh","name":"Power Knuckle","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/thor-fist.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n    sequence.effect()\n        .file(\"jb2a.unarmed_strike.physical.02.blue\")\n        .scale(0.9)\n        .atLocation(sourceToken)\n        .moveTowards(target)\n        .missed(targetsMissed.has(target.id));\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/knuckleswing.ogg\")\n        .delay(300)\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7));\n    if (!targetsMissed.has(target.id)) {\n        sequence.sound()\n            .file(\"modules/lancer-weapon-fx/soundfx/knucklehit.ogg\")\n            .delay(600)\n            .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.8))\n            .waitUntilFinished(-100);\n    }\n}\nsequence.play();"}
{"_id":"LxQMeItXellYRt3b","name":"PPC","type":"script","author":"LancerWeaponFX00","img":"modules/JB2A_DnD5e/Library/6th_Level/Chain_Lightning/ChainLightning_01_Regular_Blue_Primary_Thumb.webp","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/PPC2.ogg\")\n        .delay(400)\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));\n    sequence.effect()\n        .file(\"jb2a.chain_lightning.primary.blue\")\n        .scale(0.7)\n        .atLocation(sourceToken)\n        .stretchTo(target)\n        .missed(targetsMissed.has(target.id));\n}\nsequence.play();"}
{"name":"Preload LancerWeaponFX","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/loadfx.png","scope":"global","_id":"7DO055aDh1QmVHby","command":"await Sequencer.Preloader.preloadForClients([\"jb2a.arrow.physical.blue\",\n    \"jb2a.breath_weapons02.burst.line.fire.orange.01\",\n    \"jb2a.breath_weapons02.burst.cone.fire.orange.02\",\n    \"jb2a.bolt.physical.orange\",\n    \"jb2a.bullet.01.orange\",\n    \"jb2a.bullet.02.orange\",\n    \"jb2a.bullet.Snipe.blue\",\n    \"jb2a.burning_hands.01.orange\",\n    \"jb2a.chain_lightning.primary.blue\",\n    \"jb2a.claws.400px.red\",\n    \"jb2a.dancing_light.purplegreen\",\n    \"jb2a.disintegrate.green\",\n    \"jb2a.divine_smite.caster.blueyellow\",\n    \"jb2a.divine_smite.target.blueyellow\",\n    \"jb2a.eldritch_blast.purple\",\n    \"jb2a.energy_beam.normal.bluepink.02\",\n    \"jb2a.energy_strands.complete.blue.01\",\n    \"jb2a.energy_strands.range.multiple.purple.01.30ft\",\n    \"jb2a.explosion.01.orange\",\n    \"jb2a.explosion.02.blue\",\n    \"jb2a.explosion.03.blueyellow\",\n    \"jb2a.explosion.04.blue\",\n    \"jb2a.fireball.beam.orange\",\n    \"jb2a.fireball.explosion.orange\",\n    \"jb2a.fire_jet.orange\",\n    \"jb2a.fumes.steam.white\",\n    \"jb2a.greataxe.melee.standard.white\",\n    \"jb2a.healing_generic.400px.green\",\n    \"jb2a.impact.004.blue\",\n    \"jb2a.impact.blue\",\n    \"jb2a.impact.ground_crack.orange\",\n    \"jb2a.impact.orange.0\",\n    \"jb2a.impact.orange.3\",\n    \"jb2a.impact.yellow\",\n    \"jb2a.lasershot.blue\",\n    \"jb2a.lasershot.green\",\n    \"jb2a.lasersword.melee.blue\",\n    \"jb2a.lightning_ball.blue\",\n    \"jb2a.lightning_bolt.narrow.blue\",\n    \"jb2a.magic_missile.purple\",\n    \"jb2a.pack_hound_missile\",\n    \"jb2a.side_impact.part.smoke.blue\",\n    \"jb2a.spear.melee.01.white.2\",\n    \"jb2a.static_electricity\",\n    \"jb2a.sword.melee.01.white\",\n    \"jb2a.template_circle.vortex.loop.blue\",\n    \"jb2a.throwable.launch.missile\",\n    \"jb2a.toll_the_dead.green.shockwave\",\n    \"jb2a.unarmed_strike.physical\",\n    \"jb2a.warhammer.melee.01.white.4\",\n    \"jb2a.zoning.inward.square.loop.bluegreen.01.01\",\n    \"jb2a.zoning.inward.circle.loop\",\n    \"modules/lancer-weapon-fx/icons/LatchDrone.png\",\n    \"modules/animated-spell-effects/spell-effects/air/black_smoke_RAY_01.webm\",\n    \"modules/animated-spell-effects/spell-effects/energy/energy_throw_RAY_10.webm\",\n    \"modules/animated-spell-effects/spell-effects/energy/energy_explosion_CIRCLE_05.webm\",\n], true);"}
{"name":"Railgun","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/supersonic-bullet.png","scope":"global","_id":"iOD860W9KokfR3Hy","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nconst findFarthestTargetOfGroup = function (targetTokens) {\n    let farthestToken = null;\n    let farthestTokenDistance = 0;\n    targetTokens.forEach(t => {\n        let distance = canvas.grid.measureDistance(sourceToken, t);\n        if (distance > farthestTokenDistance) {\n            farthestToken = t;\n            farthestTokenDistance = distance;\n        }\n    });\n\n    return farthestToken;\n};\n\nconst target = findFarthestTargetOfGroup(targetTokens);\n\nconst repeatImpactAnimationForEachTarget = function (sequence, targets) {\n    targets.forEach(t => {\n        if (!targetsMissed.has(t.id)) {\n            sequence.effect()\n                .file(\"jb2a.impact.orange.0\")\n                .atLocation(t)\n                .rotateTowards(sourceToken)\n                .rotate(230)\n                .center()\n        }\n    });\n    return sequence;\n}\n\n\nlet sequence = new Sequence()\n\n        .sound()\n         .file(\"modules/lancer-weapon-fx/soundfx/Annihilator_Charge.ogg\")\n         .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n         .waitUntilFinished(-500);\n\n        sequence.effect()\n         .file(\"jb2a.bullet.Snipe.blue\")\n         .atLocation(sourceToken)\n         .stretchTo(target)\n\n        .sound()\n         .file(\"modules/lancer-weapon-fx/soundfx/AMR_Fire.ogg\")\n         .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n         \n        .sound()\n         .file(\"modules/lancer-weapon-fx/soundfx/AMR_Impact.ogg\")\n         .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n        ;\n\nsequence = repeatImpactAnimationForEachTarget(sequence, targetTokens);\n\nsequence.play();"}
{"name":"Retort Loop","type":"script","author":"LancerWeaponFX00","img":"modules/JB2A_DnD5e/Library/Generic/Energy/EnergyBeam_02_Regular_BluePink_Thumb.webp","scope":"global","_id":"NbTm6IW88EKyM6sN","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/RetortLoop.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.8));\n    sequence.effect()\n        .file(\"jb2a.energy_beam.normal.bluepink.02\")\n        .scale(0.7)\n        .atLocation(sourceToken)\n        .stretchTo(target)\n        .missed(targetsMissed.has(target.id))\n        .name(\"impact\")\n        .delay(200);\n    if (!targetsMissed.has(target.id)) {\n        sequence.effect()\n            .file(\"jb2a.impact.blue\")\n            .scale(0.3)\n            .atLocation(target, {randomOffset: 0.9})\n            .repeats(8, 200)\n            .delay(700);\n    }\n    else {\n        sequence.effect()\n            .file(\"jb2a.impact.blue\")\n            .scale(0.3)\n            .atLocation(\"impact\", {randomOffset: 0.9})\n            .repeats(8, 200)\n            .delay(700);\n    }\n}\nsequence.play();"}
{"_id":"POS2lrr0O83sNweN","name":"ShockBaton","img":"modules/lancer-weapon-fx/icons/shining-sword.png","type":"script","scope":"global","author":"LancerWeaponFX00","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n    sequence.effect()\n        .file(\"jb2a.melee_attack.01.magic_sword.yellow\")\n        .delay(500)\n        .scaleToObject(3)\n        .filter(\"ColorMatrix\", {hue: 180})\n        .atLocation(sourceToken)\n        .moveTowards(target)\n        .waitUntilFinished(-1000)\n        .missed(targetsMissed.has(target.id));\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Axe_swing.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n        .waitUntilFinished(-1450);\n\n        sequence.sound()\n            .file(\"modules/lancer-weapon-fx/soundfx/Melee.ogg\")\n            .playIf(!targetsMissed.has(target.id))\n            .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7));\n        sequence.effect()\n            .file(\"jb2a.impact.blue.2\")\n            .playIf(!targetsMissed.has(target.id))\n            .scaleToObject()\n            .atLocation(target, {randomOffset: 0.5, gridUnits:true})\n            .waitUntilFinished(-1200);\n        sequence.effect()\n            .file(\"jb2a.static_electricity.03\")\n            .playIf(!targetsMissed.has(target.id))\n            .scaleToObject(0.7)\n            .atLocation(target, {randomOffset: 0.6, gridUnits: true})\n            .repeats(3, 75)\n            .waitUntilFinished(-1200);\n}\nsequence.play();"}
{"_id":"NMU9syMKa0dTsINf","name":"Shotgun","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/shotgun-rounds.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor)\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/shotgun_cycle.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/shotgun_fire.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n        .delay(500);\n    if (!targetsMissed.has(target.id)) {\n        sequence.sound()\n            .file(\"modules/lancer-weapon-fx/soundfx/shotgun_impact.ogg\")\n            .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n            .delay(800);\n    }\n    sequence.effect()\n       .file(\"jb2a.bullet.01.orange\")\n       .atLocation(sourceToken)\n       .scale(0.9)\n       .stretchTo(target, {randomOffset: 0.7})\n       .missed(targetsMissed.has(target.id))\n       .repeats(6)\n       .delay(500)\n       .waitUntilFinished(-100);\n}\nsequence.play();"}
{"name":"Slag Cannon","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/rock.png","scope":"global","_id":"OAs6mALoTynun3lM","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nconst target = game.modules.get(\"lancer-weapon-fx\").api.getTargetLocationsFromTokenGroup(targetTokens, 1)[0];\n\nlet sequence = new Sequence()\n\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/RetortLoop.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n    sequence.effect()\n        .file(\"jb2a.breath_weapons02.burst.line\")\n        .atLocation(sourceToken)\n        .filter(\"ColorMatrix\", {hue: 180, brightness: 0.2, contrast: 0.5})\n        .filter(\"Glow\", {distance: 0.5, color: 0xd6c194, innerStrength: 2})\n        .stretchTo(target)\n        .playbackRate(1.5)\n        .waitUntilFinished(-3500);\n\nfor (let i=0; i < targetTokens.length; i++) {\n    let target = targetTokens[i];\n\n    if (!targetsMissed.has(target.id)) {\n        sequence.effect()\n            .file(\"jb2a.grease.dark_brown.loop\")\n            .opacity(0.8)\n            .fadeIn(800)\n            .fadeOut(800)\n            .atLocation(target, {randomOffset: 2, gridUnits: true})\n            .belowTokens()\n            .repeats(3)\n            .scaleToObject(1);\n    }\n}\n    sequence.play();"}
{"_id":"77szM2o5ThaLsJax","name":"Stabilize","type":"script","author":"LancerWeaponFX00","img":"modules/JB2A_DnD5e/Library/Generic/Healing/HealingAbility_01_Green_Thumb.webp","scope":"global","command":"const {sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence()\n    .sound()\n    .file(\"modules/lancer-weapon-fx/soundfx/Stabilize.ogg\")\n    .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n    .effect()\n    .file(\"jb2a.healing_generic.400px.green\")\n    .atLocation(sourceToken)\n    .play();\n"}
{"name":"Tachyon Lance","type":"script","author":"LancerWeaponFX00","img":"modules/JB2A_DnD5e/Library/Generic/Weapon_Attacks/Ranged/Bullet_03_Regular_Blue_Thumb.webp","scope":"global","_id":"BkYGErIuWCVcF4rS","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Annihilator_Charge.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n        .waitUntilFinished();\n\n    sequence.effect()\n        .file(\"jb2a.impact.orange.0\")\n        .atLocation(target, {randomOffset: 0.7})\n        .rotateTowards(sourceToken)\n        .missed(targetsMissed.has(target.id))\n        .repeats(3, 100)\n        .rotate(230)\n        .center();\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Annihilator.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n        .waitUntilFinished(-400);\n}\nsequence.play();"}
{"_id":"hI3KpcI1IYKR43lF","name":"TempestBlade","img":"modules/lancer-weapon-fx/icons/shining-sword.png","type":"script","scope":"global","author":"LancerWeaponFX00","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n    sequence.effect()\n        .file(\"jb2a.melee_attack.01.magic_sword.yellow\")\n        .delay(500)\n        .scaleToObject(6)\n        .filter(\"ColorMatrix\", {hue: 180})\n        .atLocation(sourceToken)\n        .moveTowards(target)\n        .waitUntilFinished(-1000)\n        .missed(targetsMissed.has(target.id));\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Axe_swing.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5))\n        .waitUntilFinished(-1450);\n\n        sequence.sound()\n            .file(\"modules/lancer-weapon-fx/soundfx/Melee.ogg\")\n            .playIf(!targetsMissed.has(target.id))\n            .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7));\n        sequence.effect()\n            .file(\"jb2a.impact.blue.3\")\n            .playIf(!targetsMissed.has(target.id))\n            .scaleToObject(2)\n            .atLocation(target)\n            .waitUntilFinished(-1200);\n        sequence.effect()\n            .file(\"jb2a.static_electricity.03\")\n            .playIf(!targetsMissed.has(target.id))\n            .scaleToObject()\n            .atLocation(target, {randomOffset: 0.8, gridUnits: true})\n            .repeats(3, 75)\n            .opacity(0.8)\n            .waitUntilFinished(-1200);\n}\nsequence.play();"}
{"_id":"LixHY6HTrY7D3b7S","name":"Thermal Rifle","type":"script","author":"LancerWeaponFX00","img":"modules/JB2A_DnD5e/Library/3rd_Level/Fireball/FireballBeam_01_Orange_Thumb.webp","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/WeaponBeep.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Thermal_Rifle_Fire.ogg\")\n        .delay(400)\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));\n    sequence.effect()\n        .file(\"jb2a.fireball.beam.orange\")\n        .scale(1.25)\n        .startTime(1500)\n        .atLocation(sourceToken)\n        .stretchTo(target)\n        .missed(targetsMissed.has(target.id));\n\n        sequence.sound()\n            .file(\"modules/lancer-weapon-fx/soundfx/Thermal_Rifle_Hit.ogg\")\n            .playIf(!targetsMissed.has(target.id))\n            .delay(700)\n            .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));\n        sequence.effect()\n            .file(\"jb2a.impact.orange.3\")\n            .playIf(!targetsMissed.has(target.id))\n            .atLocation(target)\n            .delay(700)\n            .waitUntilFinished();\n}\nsequence.play();"}
{"_id":"zsccsSD1tOOqRc5Q","name":"Torch","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/axe-swing.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n    sequence.effect()\n        .file(\"jb2a.greataxe.melee.standard.white\")\n        .tint(\"#c91af9\")\n        .scale(0.8)\n        .atLocation(sourceToken)\n        .moveTowards(target)\n        .missed(targetsMissed.has(target.id))\n        .waitUntilFinished(-1200)\n    .sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/Axe_swing.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7))\n \n        sequence.sound()\n            .file(\"modules/lancer-weapon-fx/soundfx/Axe_Hit.ogg\")\n            .playIf(!targetsMissed.has(target.id))\n            .delay(275)\n            .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7));\n        sequence.effect()\n            .file(\"jb2a.impact.blue.3\")\n            .playIf(!targetsMissed.has(target.id))\n            .delay(275)\n            .scaleToObject(2)\n            .tint(\"#c91af9\")\n            .atLocation(target)\n            .waitUntilFinished(-1000);\n\n}\nsequence.play();"}
{"_id":"6vtYP47LXaX5POYB","name":"Veil Rifle","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/laser-blast.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n    sequence.effect()\n        .file(\"jb2a.bullet.Snipe.blue\")\n        .filter(\"ColorMatrix\", {hue: 60})\n        .filter(\"Glow\", {distance: 3})\n        .atLocation(sourceToken)\n        .scale(0.8)\n        .stretchTo(target)\n        .missed(targetsMissed.has(target.id));\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/veil_rifle.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.5));\n}\nsequence.play();"}
{"_id":"CqlCKrYyJCYdmLks","name":"War Pike","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/barbed-spear.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nlet sequence = new Sequence();\n\nfor (const target of targetTokens) {\n    sequence.effect()\n        .file(\"jb2a.spear.melee.01.white.2\")\n        .filter(\"Glow\", {color: 0x5f5858, innerStrength: 2, knockout: true, distance: 20})\n        .scale(0.8)\n        .atLocation(sourceToken)\n        .moveTowards(target)\n        .missed(targetsMissed.has(target.id));\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/bladeswing.ogg\")\n        .delay(950)\n        .endTime(600)\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7))\n\t.waitUntilFinished(-800);\n\n        sequence.sound()\n            .file(\"modules/lancer-weapon-fx/soundfx/bladehit.ogg\")\n            .playIf(!targetsMissed.has(target.id))\n            .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.7));\n        sequence.effect()\n            .file(\"jb2a.impact.orange.3\")\n            .playIf(!targetsMissed.has(target.id))\n            .scaleToObject(2)\n            .atLocation(target)\n            .waitUntilFinished();\n}\nsequence.play();"}
{"_id":"jGNjJXWRQMh7jPhA","name":"Warp Rifle","type":"script","author":"LancerWeaponFX00","img":"modules/lancer-weapon-fx/icons/hole.png","scope":"global","command":"const {targetsMissed, targetTokens, sourceToken} = game.modules.get(\"lancer-weapon-fx\").api.getMacroVariables(typeof messageId === \"undefined\" ? null : messageId, actor);\n\nconst target = targetTokens[0];\n\nlet sequence = new Sequence()\n    .sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/DisplacerFire.ogg\")\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.8))\n        .startTime(900)\n        .fadeInAudio(500)\n    .effect()\n        .file(\"jb2a.energy_strands.range.multiple.purple.01\")\n        .scale(0.40)\n        .atLocation(sourceToken)\n        .stretchTo(target)\n        .missed(targetsMissed.has(target.id))\n        .waitUntilFinished(-1100)\n\n    sequence.sound()\n        .file(\"modules/lancer-weapon-fx/soundfx/DisplacerHit2.ogg\")\n        .playIf(!targetsMissed.has(target.id))\n        .delay(300)\n    .effect()\n        .file(\"jb2a.divine_smite.caster.blueyellow\")\n        .playIf(!targetsMissed.has(target.id))\n        .volume(game.modules.get(\"lancer-weapon-fx\").api.getEffectVolume(0.8))\n        .scaleToObject(3)\n        .tint(\"#9523e1\")\n        .filter(\"Glow\", {color: 0xffffff, distance: 1})\n        .atLocation(target)\n        .waitUntilFinished(-1000)\n\nsequence.play();"}
